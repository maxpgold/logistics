<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<h4> PLEASE WORK </h4>

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

<%= text_field_tag(:latitude, "", id: 'lat') %>
<%= text_field_tag(:longitude, "", id: 'lng') %>

<script type="text/javascript">


// WAY TO GET CURRENT GEOLOCATION
// var handler = Gmaps.build('Google');
// handler.buildMap({ internal: {id: 'geolocation'} }, function(){
//   if(navigator.geolocation)
//     navigator.geolocation.getCurrentPosition(displayOnMap);
// });

handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
        markers = handler.addMarkers([
          {
            "lat": 51.5008,
            "lng": 0.1247,
            "picture": {
              "url": "https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png",
              "width":  36,
              "height": 36
            },
            "infowindow": "hello!"
          }
        ]);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();


      google.maps.event.addListener(handler.getMap(), 'click', function(event) {
       document.getElementById('lat').innerHTML = event.latLng.lat();
       document.getElementById('lng').innerHTML = event.latLng.lng();
       alert( 'Lat: ' + event.latLng.lat() + ' and Longitude is: ' + event.latLng.lng() );
      });
    });
</script>

